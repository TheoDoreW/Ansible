---
- hosts: "{{ hosts }}" 
  user: azureuser
  tasks:
  - 
    name: "create user groups"
    group: "name={{ item.gname }} gid={{ item.gid }} state=present"
    with_items: 
      - 
        gid: "550"
        gname: www
      - 
        gid: "551"
        gname: mongod
      - 
        gid: "600"
        gname: sudo
      - 
        gid: "560"
        gname: liangjixin
      - 
        gid: "561"
        gname: fengzhibin
      -
        gid: "562"
        gname: chenxuanxin
      - 
        gid: "563"
        gname: linxuzhou
  -   
    name: "create users and add into groups"
    user: "name={{ item.name }} groups={{ item.groups }} uid={{ item.uid }} shell=/bin/bash state=present"
    with_items: 
      - 
        append: yes
        groups: www
        name: www
        uid: "550"
      - 
        append: yes
        groups: mongod
        name: mongod
        uid: "551"
      - 
        groups: "liangjixin,sudo"
        name: liangjixin
        uid: "560"
      - 
        groups: "fengzhibin,sudo"
        name: fengzhibin
        uid: "561"
      - 
        groups: "chenxuanxin,sudo"
        name: chenxuanxin
        uid: "562"
      - 
        groups: "linxuzhou,sudo"
        name: linxuzhou
        uid: "563"
        